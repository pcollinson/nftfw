.\" Automatically generated by Pandoc 2.17.1.1
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "NFTFWEDIT" "1" "" "" "Nftfw documentation"
.hy
.SH NAME
.PP
\f[B]nftfwedit\f[R] - command line to add, delete and blacklist IPs and
IP information print
.SH SYNOPSIS
.PP
\f[B]nftfwedit\f[R] [\f[B]-h\f[R]] [** -d | -r | -a | -b \f[B]]
[\f[R]-p** \f[I]PORT\f[R]] [\f[B]-m\f[R] \f[I]MATCHES\f[R]]
[\f[B]-n\f[R] \f[I]PATTERN\f[R]] [** -q \f[B]] [\f[R] -g \f[B]] [\f[R]
-v \f[B]] [\f[R] ipaddress [ ipaddress \&...
]**]
.SH DESCRIPTION
.PP
\f[I]nftfwedit\f[R] is a command line tool to add or remove IP addresses
from the \f[I]nftfw\f[R] blacklist database, and also optionally from
the \f[I]blacklist.d\f[R] directory affecting the running firewall.
Options on the command line are followed by one of more IP addresses.
.PP
If one of the \f[B]delete\f[R] (\f[B]-d\f[R]) , \f[B]remove\f[R]
(\f[B]-r\f[R]), \f[B]add\f[R] (\f[B]-a\f[R]) or \f[B]blacklist\f[R]
(\f[B]-b\f[R]) options is not supplied, \f[I]nftfwedit\f[R] prints
information about its ip address arguments.
Information from the blacklist database is printed if available, along
with the country of origin (if \f[I]geoip2\f[R] is installed) and output
from any DNS blocklists, if specified in \f[I]config.ini\f[R].
.PP
These are the available options to the program:
.TP
\f[B]-h\f[R], \f[B]--help\f[R]
Prints brief usage information.
.TP
\f[B]-d\f[R], \f[B]--delete\f[R]
The nominated IP addresses are deleted from the blacklist database, and
if present, the file is removed from the \f[I]blacklist.d\f[R]
directory.
Requires root access.
.TP
\f[B]-r\f[R], \f[B]--remove\f[R]
The nominated IP addresses are removed from the \f[I]blacklist.d\f[R]
directory.
The database is not touched.
Requires root access.
.TP
\f[B]-a\f[R], \f[B]--add\f[R]
The nominated IP addresses are added to the blacklist database.
For a new item, the port (\f[B]-p\f[R]) and pattern (\f[B]-n\f[R])
options must be supplied.
A match count (\f[B]-m\f[R]*) can also be supplied.
Requires root access.
.TP
\f[B]-b\f[R], \f[B]--blacklist\f[R]
The nominated IP addresses are added to the \f[I]blacklist.d\f[R]
directory and the blacklist database.
For a new item, the port (\f[B]-p\f[R]) and pattern (\f[B]-n\f[R])
options must be supplied.
A match count (\f[B]-m\f[R]*) can also be supplied.
The count may be adjusted to ensure that the nftfw blacklist command
will not remove the file automatically.
Subsequent use with the same IP address will increment the counts.
Requires root access.
.TP
\f[B]-g\f[R], \f[B]--gethostname\f[R]
Include hostname information when printing ip address information.
This is optional because name lookups can be slow for ip addresses with
known hostname.
.TP
\f[B]-p\f[R],\f[B]--port\f[R] PORT
Supply the ports used when blocking the IP address.
The PORT value can be \f[I]all\f[R], a single numeric port number, the
name of a service found in \f[I]/etc/services\f[R] or a comma separated
list of numeric ports and names.
.TP
\f[B]-n\f[R],\f[B]--pattern\f[R] PATTERN
Supply the pattern name stored in the database and used to indicate the
source of the blacklist entry when listed by \f[I]nftfwls\f[R].
Suppress printing of errors and information messages to the terminal,
syslog output remains active.
Terminal output is suppressed when the output is not directed to a
terminal.
.TP
\f[B]-m\f[R],\f[B]--matches\f[R] MATCHES
For the \f[B]-a\f[R] or \f[B]-b\f[R] actions, set the number of matches
used to count the number of problems found in logfiles.
For new database entries with the \f[B]-b\f[R]* option, this is forced
to be a minimum of 10 (the default `block after' value), ensuring that
the control file in blacklist.d isn\[cq]t deleted.
For the \f[B]-a\f[R] option, the value defaults to 1.
When the \f[B]-a\f[R] and \f[B]-b\f[R] options are updating extant
database entries, the count defaults to 1 which is added to the stored
count.
.TP
\f[B]-q\f[R], \f[B]--quiet\f[R]
Suppress printing of errors and information messages to the terminal,
syslog output remains active.
Terminal output is suppressed when the output is not directed to a
terminal.
.TP
\f[B]-v\f[R], \f[B]--verbose\f[R]
Change the default logging settings to INFO to show all errors and
information messages.
.SH FILES
.PP
Files can be located in \f[I]/\f[R] or \f[I]/usr/local\f[R].
.TP
\f[I]/etc/nftfw\f[R]
Location of control files and directories
.TP
\f[I]/etc/nftfw/nftfw_init.nft\f[R]
\f[B]nftables\f[R] basic framework
.TP
\f[I]/etc/nftfw/config.ini\f[R]
ini file with basic settings for \f[I]nftfw\f[R], overriding built-in
values
.TP
\f[I]/var/lib/nftfw/\f[R]
Location of \f[I]build.d\f[R], \f[I]test.d\f[R], \f[I]install.d\f[R],
lock files and the sqlite3 databases storing file positions and
blacklist information
.SH BUGS
.PP
See GitHub Issues: <https://github.com/pcollinson/nftfw/issues>
.SH AUTHOR
.PP
Peter Collinson (huge credit to the ideas from Patrick Cherry\[cq]s work
for the firewall for the Symbiosis hosting system).
.SH SEE ALSO
.PP
\f[B]nft(1)\f[R], \f[B]nftfwls(1)\f[R], \f[B]nftnetchk(1)\f[R],
\f[B]nftfwadm(1)\f[R], \f[B]nftfw-config(5)\f[R],
\f[B]nftfw-files(5)\f[R]
