.\" Automatically generated by Pandoc 2.17.1.1
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "NFTFWLS" "1" "" "" "Nftfw documentation"
.hy
.SH NAME
.PP
\f[B]nftfwls\f[R] - list \f[B]nftfw\f[R] blacklist database
.SH SYNOPSIS
.PP
\f[B]nftfwls\f[R] [\f[B]-h\f[R]] [\f[B]-c\f[R] \f[I]config\f[R]]
[\f[B]-p\f[R] yes|no ] [\f[B]-a |-r | -m | -i | -n | -w | -q | -v | -g
\f[R]]
.SH DESCRIPTION
.PP
\f[B]nftfwls\f[R] displays the status of the database storing the state
of the \f[B]nftfw\f[R] firewall.
The default output only displays the IP addresses found in
\f[I]/etc/nftfw/blacklist.d\f[R].
The \f[B]-a\f[R] option shows all entries in the database, and ignores
the contents of the \f[I]blacklist.d\f[R] directory.
HTML output is also possible.
.PP
\f[B]nftfwls\f[R] `pretty prints' a table with these headings:
.IP \[bu] 2
IPs: The blocked IP address
.IP \[bu] 2
Port: The port list used in the firewall for the IP
.IP \[bu] 2
Ct/Incd: The number of matches in log files triggered by this IP; a /
and the number of reported distinct incidents
.IP \[bu] 2
Latest: The date and time of the latest incident.
The \f[I]date_fmt\f[R] key in \f[I]config.ini\f[R] can alter date
formats from the default.
.IP \[bu] 2
First: The date and time of the first incident (or a minus sign `-' if
it\[cq]s the same as Latest)
.IP \[bu] 2
Duration: The time difference between the two times
.IP \[bu] 2
Pattern: The pattern or patterns that reported the incident or incidents
.PP
If the \f[I]geoip2\f[R] country database is available, the IP address is
preceded by the ISO two letter country code of te site where the IP is
located.
.SS Text output
.PP
Text output uses the Python `prettytable' module.
When piping the output into another program, it\[cq]s helpful to remove
the column separators, adding \f[B]-n\f[R] option make this happen.
.SS HTML output
.PP
The \f[B]-w\f[R] option selects HTML output.
It prints an HTML table suitable for inclusion on a web page.
Classes in the table allow styling.
.IP \[bu] 2
Class: `nftfwls' - for <table>
.IP \[bu] 2
Class: `heading' for the heading <tr>
.IP \[bu] 2
Class; `content' for the remaining <tr> lines
.IP \[bu] 2
Class: `col1', `col2', up to `col7' for the appropriate <td> cells.
.PP
If the \f[I]geoip2\f[R] country database is available, the IP address is
preceded by the ISO two letter country code of te site where the IP is
located.
Mouse over the code to get the full country name.
.SS Options
.TP
\f[B]-h\f[R], \f[B]--help\f[R]
Prints brief usage information.
.TP
\f[B]-w\f[R], \f[B]--web\f[R]
Print output as an HTML table, enabling integration into a web page.
.TP
\f[B]-a \f[R], \f[B]--all\f[R]
Prints all the informarion in the database, ignoring entries in
\f[I]blacklist.d\f[R]
.TP
\f[B]-g \f[R], \f[B]--nogeo\f[R]
Suppresses the display of countries from GeoIP which will be shown if
the geoip library is installed on the system.
.TP
\f[B]-p \f[R], \f[B]--pattern_split\f[R] yes|no
If `yes', splits the pattern column at any comma, making separate lines
for entries with more than one stored pattern; if `no' prints a single
line for the pattern column.
The \f[I]pattern_split\f[R] value in the config.ini file sets the usual
default value.
.TP
\f[B]-r\f[R], \f[B]--reverse\f[R]
Reverse sorting order
.TP
\f[B]-m\f[R], \f[B]--matchcount\f[R]
Sort by match count
.TP
\f[B]-i\f[R], \f[B]--incidents\f[R]
Sort by incidents
.TP
\f[B]-n\f[R], \f[B]--noborder\f[R]
Don\[cq]t print a border to the table.
.TP
\f[B]-c \f[R], \f[B]--config\f[R] CONFIG
Supply a configuration file, overriding any values from the default
system settings.
.TP
\f[B]-q\f[R], \f[B]--quiet\f[R]
Suppress printing of errors and information messages to the terminal,
syslog output remains active.
Terminal output is suppressed when the output is not directed to a
terminal
.TP
\f[B]-v\f[R], \f[B]--verbose\f[R]
Change the default logging settings to INFO to show all errors and
information messages.
.SH FILES
.PP
Files can be located in \f[I]/\f[R] or \f[I]/usr/local\f[R].
.TP
\f[I]/etc/nftfw\f[R]
Location of control files
.TP
\f[I]/var/lib/nftfw/\f[R]
Location of \f[I]build\f[R], \f[I]install\f[R], lock file and sqlite3
databases storing file positions and blacklist information
.SH BUGS
.PP
See GitHub Issues: <https://github.com/pcollinson/nftfw/issues>
.SH AUTHOR
.PP
Peter Collinson (huge credit to the ideas from Patrick Cherry\[cq]s work
for the firewall for the Symbiosis hosting system).
.SH SEE ALSO
.PP
\f[B]nft(1)\f[R], \f[B]nftfw(1)\f[R], \f[B]nftfwedit(1)\f[R],
\f[B]nftfwadm(1)\f[R], \f[B]nftfw-config(5)\f[R],
\f[B]nftfw-files(5)\f[R]
